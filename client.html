<!DOCTYPE html>
<html>
<body>
  <button onclick="countPress('support')">Support</button>
  <button onclick="countPress('obstruct')">Obstruct</button>

  <script>
    const socket = new WebSocket("ws://localhost:8080/ws");

    let counts = { support: 0, obstruct: 0 };

    function countPress(team) {
      counts[team]++;
    }

    // 1秒毎にまとめて送信
    setInterval(() => {
      if (counts.support === 0 && counts.obstruct === 0) return;

      const msg = {
        support: counts.support,
        obstruct: counts.obstruct
      };
      socket.send(JSON.stringify(msg));

      // リセット
      counts.support = 0;
      counts.obstruct = 0;
    }, 1000);

    socket.onopen = () => {
      console.log("WebSocket connected");
    };

    socket.onmessage = (event) => {
      console.log("Received from server:", event.data);
    };
  </script>
</body>
</html>
